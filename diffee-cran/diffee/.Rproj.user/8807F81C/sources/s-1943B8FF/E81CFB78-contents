

### load the diffee library
library(diffee)
graphics.off()
par(mfrow=c(1,1))


readline(prompt="Press [enter] to continue to the first demo: cancerdemo")


### load the cancer data
data(cancer)
X = list(as.matrix(cancer[[1]][which(cancer[[2]] == "not"),]), as.matrix(cancer[[1]][which(cancer[[2]] == "pcr"),]))

### run the diffee
cancerresult = diffee(X[[1]], X[[2]], 40)


### plot the estimated graphs by diffee
plot.diffee(cancerresult)


readline(prompt="Press [enter] to continue to the second demo: exampledata demo")



### load the  example data
data(exampleData)


### run simule algorithm to estimate two sparse precision matrices from the exampleData
exampleresults = diffee(exampleData[[1]], exampleData[[2]], 0.45)


### plot the estimated graphs by diffee

data(exampleDataGraph)
par(mfrow=c(1,2))


examplelayout = layout_nicely(exampleDataGraph[[1]])

{
plot.diffee(exampleresults,graphlayout = examplelayout)

plot.igraph(union(exampleDataGraph[[2]], exampleDataGraph[[3]]),layout = examplelayout,vertex.label.font=2,
            vertex.shape="none",
            vertex.label.color="gray40",
            vertex.label.cex=.7, vertex.frame.color="white", vertex.size = 10 ,
            edge.color = categorical_pal(3)[1],
            main = "difference graph ground truth")
}


readline(prompt="Press [enter] to continue to the third demo: large p example data demo")

data(exampleData500)

{
  start_time = Sys.time()
  diffee(exampleData500[[1]], exampleData500[[2]], 1)
  end_time = Sys.time()
  print(paste("the time taken for DIFFEE to run with p = 500 is", end_time - start_time, "seconds"))
}


readline(prompt="Press [enter] to continue to the fourth demo: NIPS word count demo")

par(mfrow=c(1,1))

### load nips word count data
data(nip_37_data)

dataname = colnames(datalist[[1]])

results = diffee(datalist[[1]], datalist[[2]] , 0.0035)

plot.diffee(results, graphlabel = dataname)


readline(prompt="Press [enter] to continue to the fifth demo: brain demo")


### brain demo currently not available
if(FALSE){
library(brainGraph)

pause()


data(niidatalist)

data("aal116")

dataname = aal116$name

pause()


# please load finaldatalist.rds
# please tune the parameters
results = diffee(niidatalist[[1]], niidatalist[[2]], 0.06)


#saveRDS(aal116, "aal116.rds")

diffgraph = plot.diffee(results, dataname, isreturn = TRUE)
diffgraphmade <- make_brainGraph(diffgraph, atlas = "aal116")


pause()

# type in sharegraphmade
plot_brainGraph_gui()
}
